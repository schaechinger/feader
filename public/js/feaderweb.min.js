function addFead(e){var t=e.getElementsByTagName("a")[0].getAttribute("data-url");if(0===t.indexOf("//"))t="http:"+t;else if(0===t.indexOf("/")){var n=location.href.indexOf("/",8);t=-1===n?location.href+t:location.href.substr(0,n)+t}window.feader.fead=e;var i=document.createElement("img");i.setAttribute("src",domain+"/img/blue/icon.png"),i.setAttribute("class","loading"),e.insertBefore(i,e.firstChild),feaderSendUrl(t)}function feaderSendUrl(e){var t="";void 0!==e&&(t+="u="+encodeURIComponent(e)+"&"),feaderSendRequest("/webimporter/add?"+t)}function feaderSendStatus(){feaderSendRequest("/webimporter/status?")}function feaderSendRequest(e){var t=function(){window.feader.checkResponse()},n=document.createElement("img");n.setAttribute("src",window.domain+e+"r="+Math.random()),n.setAttribute("class","response"),n.onload=t,document.getElementById("feads").appendChild(n),window.feader.img=n,window.feader.timer=setInterval(t,250)}function feaderClose(){document.getElementsByTagName("body")[0].removeChild(window.feader.el)}!function(e,t){e.charset="UTF-8";var n="https://www.feader.eu";t.domain=n;var i={de:{available:"Verfügbare feads",deniedDesc:"Sie müssen sich anmelden, um den Web-Importer nutzen zu können!!",deniedLink:"Anmelden",deniedTitle:"Anmeldung erforderlich",help:"Hilfe",loading:"Suche feads ...",notFound:"Keine feads gefunden",title:"feads hinzufügen"},en:{available:"Available feads",deniedDesc:"You need to login before you can use the web importer!",deniedLink:"Log in",deniedTitle:"Log in required",help:"Help",loading:"searching feads ...",notFound:"No feads found",title:"Add feads"}},r=navigator.language||navigator.userLanguage;"de"!==r&&(r="en");var a=i[r],o={el:void 0,feads:void 0,img:void 0,fead:void 0,timer:void 0,init:function(){this.el=e.createElement("div"),this.el.setAttribute("id","feader"),this.el.innerHTML='<div class="head"><a href="'+n+'" target="_blank">'+'<img src="'+n+'/img/blue/app-74.png" alt="feader" class="icon"></a>'+"<h1>"+a.title+'</h1><a onclick="feaderClose()" class="closeButton">x</a><div class="clear"></div></div>'+'<div id="feads"></div>'+'<div class="footer"><p>&copy; 2013 feader</p><a href="'+n+'/help/webimporter" target="_blank">'+a.help+'</a><div class="clear"></div></div>',e.getElementsByTagName("body")[0].appendChild(this.el),this.reset()},reset:function(){e.getElementById("feads").innerHTML='<p class="center">'+a.loading+"</p>",feaderSendStatus()},load:function(){var t,n=this,i=location.href;return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var i=t.responseText;null!==i&&(n.parse(i),n.display()),(null===i||0===n.feads.length)&&(e.getElementById("feads").innerHTML='<p class="center">'+a.notFound+"</p>")}},t.open("GET",i,!0),t.send(),!1},display:function(){if(0<this.feads.length){var t=e.createElement("h2");t.innerHTML=a.available,e.getElementById("feads").innerHTML="",e.getElementById("feads").appendChild(t);for(var n=0;n<this.feads.length;n++){var i=e.createElement("p");i.setAttribute("onclick","addFead(this)"),i.setAttribute("class","fead");var r=e.createElement("a");"atom"===this.feads[n].type&&r.setAttribute("class","atom"),r.setAttribute("data-url",this.feads[n].url),r.innerHTML=this.feads[n].title,i.appendChild(r);var o=e.createElement("div");o.setAttribute("class","clear"),i.appendChild(o),e.getElementById("feads").appendChild(i)}}},parse:function(e){var t=e.indexOf("<head"),n=e.indexOf("/head>");for(e=e.substr(t,n-t+6),t=-1,this.feads=[];-1!=(t=e.indexOf("<link",t+1));){var i=e.substring(t,e.indexOf(">",t)+1),r=i.indexOf('rel="');if(-1!==r){r+=5;var a=i.substring(r,i.indexOf('"',r));if("alternate"===a){r=i.indexOf('type="');var o="unknown";if(-1!==r){r+=6,o=i.substring(r,i.indexOf('"',r)),"application/rss+xml"===o.toLowerCase()?o="rss":"application/atom+xml"===o.toLowerCase()&&(o="atom"),r=i.indexOf('title="');var s="fead";-1!==r&&(r+=7,s=i.substring(r,i.indexOf('"',r))),r=i.indexOf('href="')+6;var l=i.substring(r,i.indexOf('"',r));this.feads.push({title:s,url:l,type:o})}}}}},denied:function(){var t=e.createElement("div"),i=e.createElement("h2");i.innerHTML=a.deniedTitle;var r=e.createElement("p");r.innerHTML=a.deniedDesc;var o=e.createElement("a");o.setAttribute("href",n+"/user/login"),o.setAttribute("target","_blank"),o.setAttribute("class","feaderButton"),o.innerHTML=a.deniedLink,t.appendChild(i),t.appendChild(r),t.appendChild(o),e.getElementById("feads").innerHTML="",e.getElementById("feads").appendChild(t)},success:function(){this.fead.setAttribute("class","fead success"),this.fead.removeChild(this.fead.getElementsByTagName("img")[0]);var t=e.createElement("img");t.setAttribute("src",n+"/img/webimporter/success.png"),this.fead.insertBefore(t,this.fead.firstChild)},failed:function(){this.fead.setAttribute("class","fead error"),this.fead.removeChild(this.fead.getElementsByTagName("img")[0]);var t=e.createElement("img");t.setAttribute("src",n+"/img/webimporter/failed.png"),this.fead.insertBefore(t,this.fead.firstChild)},checkResponse:function(){if(this.img&&0<this.img.width){clearInterval(this.timer);var e=this.img.width;1===e?this.success():2===e?this.failed():3===e?this.denied():4===e&&this.load()}}};if(t.feader=o,null===e.getElementById("feader")){var s=e.createElement("link");s.setAttribute("href",n+"/css/feaderweb.min.css?r="+Math.random()),s.setAttribute("type","text/css"),s.setAttribute("rel","stylesheet"),e.getElementsByTagName("head")[0].appendChild(s),o.init()}else o.reset()}(document,window);